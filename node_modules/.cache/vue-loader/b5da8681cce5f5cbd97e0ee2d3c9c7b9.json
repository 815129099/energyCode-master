{"remainingRequest":"D:\\code\\energyCode-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\code\\energyCode-master\\src\\components\\page\\User.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\code\\energyCode-master\\src\\components\\page\\User.vue","mtime":1564553326000},{"path":"D:\\code\\energyCode-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1606188053867},{"path":"D:\\code\\energyCode-master\\node_modules\\babel-loader\\lib\\index.js","mtime":1564553326000},{"path":"D:\\code\\energyCode-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1606188053867},{"path":"D:\\code\\energyCode-master\\node_modules\\vue-loader\\lib\\index.js","mtime":1564553326000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport API from '@/api';\nimport Vue from 'vue';\nexport default {\n  data() {\n    return {\n      //表格当前页数据\n      tableData: [],\n      //多选数组\n      multipleSelection: [],\n      //搜索条件\n      criteria: '',\n      //下拉菜单选项\n      select: '',\n      //默认每页数据量\n      pagesize: 10,\n      //默认高亮行数据id\n      highlightId: -1,\n      //当前页码\n      currentPage: 1,\n      //查询的页码\n      start: 1,\n      //默认数据总数\n      totalCount: 1000,\n      roles: [],//角色列表\n      editUserForm: {\n        geNumber: '',\n        userState: '',\n        roleId:'',\n        geName:''\n      },\n      addUserForm: {\n        geNumber: '',\n        geName: '',\n        userState: '',\n        roleId: '',\n        phone: '',\n        email: '',\n        password: ''\n      },\n      dialogFormVisible: false,\n      addFormVisible: false,\n      formLabelWidth: '120px',\n      rules: {\n        geNumber: [\n          { required: true, message: '请填写工号', trigger: 'blur' },\n          { min: 7, max: 7, message: '请填写7个字符的工号', trigger: 'blur' }\n        ],\n        geName: [\n          { required: true, message: '请填写姓名', trigger: 'blur' },\n          { min: 2, max: 4, message: '请填写2-4个字符的姓名', trigger: 'blur' }\n        ],\n        roleId: [\n          { required: true, message: '请选择角色', trigger: 'blur' }\n        ],\n        password: [\n          { required: true, message: '请填写密码', trigger: 'blur' },\n          { min: 6, max: 10, message: '请填写6-10个字符的密码', trigger: 'blur' }\n        ],\n        userState: [\n          { required: true, message: '请选择状态', trigger: 'blur' }\n        ],\n        phone: [\n          {\n            validator: (rule, value, callback) => {\n              let vdt = API.validate.VDATA(value, { \"required\": { msg: \"请输入手机号\" }, \"mphone\": { msg: \"请输入有效的手机号\" } })\n              if (!vdt.result) {\n                callback(new Error(vdt.msg))\n              } else {\n                callback();\n              }\n            },\n            trigger: 'blur'\n          }\n        ],\n        email: [\n          {\n            validator: (rule, value, callback) => {\n              let vdt = API.validate.VDATA(value, { \"required\": { msg: \"请输入邮箱\" }, \"email\": { msg: \"请输入有效的邮箱\" } })\n              if (!vdt.result) {\n                callback(new Error(vdt.msg))\n              } else {\n                callback();\n              }\n            },\n            trigger: 'blur'\n          }\n        ],\n      }\n    }\n  },\n  created() {\n    this.loadData(this.criteria, this.currentPage, this.pagesize);\n    if (this.hasPerm('user:add') || this.hasPerm('user:update')) {\n      this.getAllRoles();\n    }\n  },\n  methods: {\n    //从服务器读取数据\n    loadData: function (criteria, pageNum, pageSize) {\n      let params = {\n        'parameter': criteria,\n        'pageNum': pageNum,\n        'pageSize': pageSize\n      };\n      API.userUtil.getData(params).then(({ data }) => {\n        console.log(data);\n        if (data.status == 0) {\n          this.tableData = data.data.userData;\n          this.totalCount = data.data.number;\n        } else {\n          //this.$Message.error(data.msg);\n          this.$message(\"请求失败！\");\n        }\n      }).catch((data) => {\n        this.$message(\"请求失败ww！\");\n        console.log(data);\n      });\n    },\n    getAllRoles() {\n      this.api({\n        url: \"/api/user/getAllRoles\",\n        method: \"get\"\n      }).then(data => {\n        this.roles = data.list;\n      })\n    },\n    //多选响应\n    handleSelectionChange: function (val) {\n      this.multipleSelection = val;\n    },\n\n    //点击行响应\n    handleclick: function (row, event, column) {\n      this.highlightId = row.id;\n    },\n\n    //编辑\n    handleEdit: function (index, row) {\n      this.editUserForm.geNumber = row.geNumber;\n      this.editUserForm.userState = row.userState;\n      this.editUserForm.geName = row.geName;\n      this.dialogFormVisible = true;\n    },\n\n    //修改\n    editSubmitForm(editUserForm) {\n      let params = {\n        'geNumber': this.editUserForm.geNumber,\n        'userState': this.editUserForm.userState,\n        'geName': this.editUserForm.geName,\n        'roleId': this.editUserForm.roleId\n      };\n      this.$refs[editUserForm].validate((valid) => {\n        if (valid) {\n          API.userUtil.updateUser(params).then(({ data }) => {\n            if (data.data == true) {\n              this.dialogFormVisible = false;\n              this.loadData(this.criteria, this.currentPage, this.pagesize);\n              //this.editUserForm.resetFields();\n              this.$message(\"修改成功！\");\n              this.$refs['editUserForm'].resetFields();\n            } else {\n              this.$message(\"请求失败！\");\n              this.$refs['editUserForm'].resetFields();\n            }\n          }).catch((data) => {\n            this.$message(\"请求失败！\");\n            this.$refs['editUserForm'].resetFields();\n            console.log(data);\n          });\n        } else {\n          this.$message.error(\"请求失败！\");\n          this.$refs['editUserForm'].resetFields();\n          return false;\n        }\n      });\n    },\n\n    //添加用户\n    addSubmitForm(addUserForm) {\n      let params = {\n        'geNumber': this.addUserForm.geNumber,\n        'geName': this.addUserForm.geName,\n        'userState': this.addUserForm.userState,\n        'roleId': this.addUserForm.roleId,\n        'phone': this.addUserForm.phone,\n        'email': this.addUserForm.email,\n        'password': this.addUserForm.password\n      };\n\n      this.$refs[addUserForm].validate((valid) => {\n        if (valid) {\n          API.userUtil.addUser(params).then(({ data }) => {\n            if (data.data == true) {\n              this.addFormVisible = false;\n              this.$message(\"添加成功!\");\n              this.$refs['addUserForm'].resetFields();\n              this.loadData(this.criteria, this.currentPage, this.pagesize);\n            } else {\n              this.$message(data.data);\n              this.$refs['addUserForm'].resetFields();\n            }\n          }).catch((data) => {\n            this.$message(data.data);\n            this.$refs['addUserForm'].resetFields();\n            console.log(data);\n          });\n        } else {\n          return false;\n        }\n      });\n    },\n\n    //单行删除\n    handleDelete: function (index, row) {\n      let params = { 'geNumber': row.geNumber };\n      this.$confirm('此操作将永久删除“' + row.geNumber + '”, 是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        API.userUtil.deleteUser(params).then(({ data }) => {\n          if (data.data == true) {\n            this.$message({ type: 'success', message: '删除成功!' });\n            this.loadData(this.criteria, this.currentPage, this.pagesize);\n          } else {\n            this.$message({ type: 'info', message: '删除失败' });\n          }\n        }).catch((data) => {\n          this.$message(\"请求失败！\");\n        });\n        this.$message({ type: 'success', message: '删除成功!' });\n      }).catch(() => {\n        this.$message({ type: 'info', message: '已取消删除' });\n      })\n    },\n\n    //搜索\n    search: function () {\n      console.log(this.select);\n      this.loadData(this.criteria, this.currentPage, this.pagesize);\n    },\n    add: function () {\n      this.addFormVisible = true;\n    },\n    exportUser() {\n      window.location.href = \"http://localhost:8088/api/exportUser.do\";\n    },\n    /*\n        //多项删除\n        deletenames: function(){\n          if(this.multipleSelection.length==0)\n            return;\n          var array = [];\n          this.multipleSelection.forEach((item) = > {\n            array.push(item.id);\n          })\n      this.$http.post('../delete',{\"array\":array},{emulateJSON: true}).then(function(res){\n        this.loadData(this.criteria, this.currentPage, this.pagesize);\n            },function(){\n                console.log('failed');\n            });\n        },\n      */\n    //改变当前点击的行的class，高亮当前行\n    tableRowClassName: function (row, index) {\n      if (row.id == this.highlightId) {\n        return 'info-row';\n      }\n    },\n\n    //每页显示数据量变更\n    handleSizeChange: function (val) {\n      this.pagesize = val;\n      this.loadData(this.criteria, this.currentPage, this.pagesize);\n    },\n\n    //页码变更\n    handleCurrentChange: function (val) {\n      this.currentPage = val;\n      this.loadData(this.criteria, this.currentPage, this.pagesize);\n    },\n\n  },\n\n}\n",{"version":3,"sources":["User.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA","file":"User.vue","sourceRoot":"src\\components\\page","sourcesContent":["<template>\n  <div>\n    <!--\n    <div id=\"top\">\t\t\t\n\t\t\t<span>\n\t\t\t\t<el-button type=\"text\" @click=\"dialogFormVisible = true\" style=\"color:white\" >添加</el-button>\n\t\t\t\t<el-button type=\"text\" @click=\"deletenames\" style=\"color:white\">批量删除</el-button>\n\t\t\t</span>\t\t\t\t\t\t\n\t\t</div>\t\n    <br/>-->\n    <div style=\"margin-top:15px\">\n      <el-input placeholder=\"请输入内容\" v-model=\"criteria\" style=\"padding-bottom:10px;\">\n        <el-select v-model=\"select\" slot=\"prepend\" placeholder=\"请选择\">\n          <!--<el-option label=\"id\" value=\"1\"></el-option>-->\n          <el-option label=\"工号\" value=\"1\"></el-option>\n          <el-option label=\"姓名\" value=\"2\"></el-option>\n          <el-option label=\"状态\" value=\"3\"></el-option>\n          <el-option label=\"电话\" value=\"4\"></el-option>\n        </el-select>\n        <el-button slot=\"append\" icon=\"el-icon-search\" v-on:click=\"search\">查询</el-button>\n        <el-button slot=\"append\" icon=\"el-icon-plus\" v-on:click=\"add\">添加</el-button>\n        <el-button slot=\"append\" icon=\"el-icon-upload2\" v-on:click=\"exportUser\">导出</el-button>\n      </el-input>\n\n      <el-table\n        ref=\"testTable\"\n        :data=\"tableData\"\n        style=\"width:100%\"\n        border\n        :default-sort=\"{prop: 'id', order: 'ascending'}\"\n        @selection-change=\"handleSelectionChange\"\n        @row-click=\"handleclick\"\n        :row-class-name=\"tableRowClassName\"\n      >\n        <el-table-column type=\"selection\"></el-table-column>\n        <!--\n\t\t    <el-table-column\n\t\t      prop=\"id\"\n\t\t      label=\"Id\"\n\t\t      sortable\n\t\t      show-overflow-tooltip>\n        </el-table-column>-->\n        <el-table-column prop=\"geNumber\" width=\"95px\" label=\"工号\" sortable></el-table-column>\n        <el-table-column prop=\"geName\" label=\"姓名\" width=\"88px\" sortable></el-table-column>\n        <el-table-column prop=\"userState\" label=\"状态\" width=\"88px\" sortable></el-table-column>\n        <el-table-column prop=\"phone\" label=\"电话\" sortable></el-table-column>\n        <el-table-column prop=\"email\" label=\"邮箱\" sortable></el-table-column>\n        <el-table-column prop=\"createTime\" label=\"创建时间\" sortable></el-table-column>\n        <el-table-column prop=\"updateTime\" label=\"修改时间\" sortable></el-table-column>\n        <el-table-column label=\"操作\">\n          <template scope=\"scope\">\n            <el-button size=\"small\" type=\"primary\" @click=\"handleEdit(scope.$index, scope.row)\">编辑</el-button>\n            <el-button size=\"small\" type=\"danger\" @click=\"handleDelete(scope.$index, scope.row)\">删除</el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n\n      <el-dialog title=\"修改用户\" :visible.sync=\"dialogFormVisible\">\n        <el-form :model=\"editUserForm\" :rules=\"rules\" ref=\"editUserForm\">\n          <el-form-item label=\"用户工号\" :label-width=\"formLabelWidth\" prop=\"geNumber\">\n            <el-input v-model=\"editUserForm.geNumber\" auto-complete=\"off\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"用户状态\" :label-width=\"formLabelWidth\" prop=\"userState\">\n            <el-select v-model=\"editUserForm.userState\" placeholder=\"状态\">\n              <el-option label=\"有效\" value=\"有效\"></el-option>\n              <el-option label=\"无效\" value=\"无效\"></el-option>\n            </el-select>\n          </el-form-item>\n          <el-form-item label=\"姓名\" :label-width=\"formLabelWidth\" prop=\"geName\">\n            <el-input v-model=\"editUserForm.geName\" auto-complete=\"off\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"角色\" :label-width=\"formLabelWidth\" prop=\"roleId\">\n            <el-select v-model=\"editUserForm.roleId\" placeholder=\"请选择\">\n              <el-option\n                v-for=\"item in roles\"\n                :key=\"item.roleId\"\n                :label=\"item.roleName\"\n                :value=\"item.roleId\"\n              ></el-option>\n            </el-select>\n          </el-form-item>\n        </el-form>\n        <div slot=\"footer\" class=\"dialog-footer\">\n          <el-button @click=\"dialogFormVisible = false\">取 消</el-button>\n          <el-button type=\"primary\" @click=\"editSubmitForm('editUserForm')\">确 定</el-button>\n        </div>\n      </el-dialog>\n\n      <el-dialog title=\"添加用户\" :visible.sync=\"addFormVisible\">\n        <el-form :model=\"addUserForm\" :rules=\"rules\" ref=\"addUserForm\">\n          <el-form-item label=\"工号\" :label-width=\"formLabelWidth\" prop=\"geNumber\">\n            <el-input v-model=\"addUserForm.geNumber\" auto-complete=\"off\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"姓名\" :label-width=\"formLabelWidth\" prop=\"geName\">\n            <el-input v-model=\"addUserForm.geName\" auto-complete=\"off\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"角色\" :label-width=\"formLabelWidth\" prop=\"roleId\">\n            <el-select v-model=\"addUserForm.roleId\" placeholder=\"请选择\">\n              <el-option\n                v-for=\"item in roles\"\n                :key=\"item.roleId\"\n                :label=\"item.roleName\"\n                :value=\"item.roleId\"\n              ></el-option>\n            </el-select>\n          </el-form-item>\n          <el-form-item label=\"状态\" :label-width=\"formLabelWidth\" prop=\"userState\">\n            <el-select v-model=\"addUserForm.userState\" placeholder=\"状态\">\n              <el-option label=\"有效\" value=\"有效\"></el-option>\n              <el-option label=\"无效\" value=\"无效\"></el-option>\n            </el-select>\n          </el-form-item>\n          <el-form-item label=\"密码\" :label-width=\"formLabelWidth\" prop=\"password\">\n            <el-input v-model=\"addUserForm.password\" auto-complete=\"off\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"手机号\" :label-width=\"formLabelWidth\" prop=\"phone\">\n            <el-input v-model=\"addUserForm.phone\" auto-complete=\"off\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"邮箱\" :label-width=\"formLabelWidth\" prop=\"email\">\n            <el-input v-model=\"addUserForm.email\" auto-complete=\"off\"></el-input>\n          </el-form-item>\n        </el-form>\n        <div slot=\"footer\" class=\"dialog-footer\">\n          <el-button @click=\"addFormVisible = false\">取 消</el-button>\n          <el-button type=\"primary\" @click=\"addSubmitForm('addUserForm')\">确 定</el-button>\n        </div>\n      </el-dialog>\n\n      <div align=\"center\">\n        <el-pagination\n          @size-change=\"handleSizeChange\"\n          @current-change=\"handleCurrentChange\"\n          :current-page=\"currentPage\"\n          :page-sizes=\"[5,10, 20, 30, 40]\"\n          :page-size=\"pagesize\"\n          layout=\"total, sizes, prev, pager, next, jumper\"\n          :total=\"totalCount\"\n        ></el-pagination>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport API from '@/api';\nimport Vue from 'vue';\nexport default {\n  data() {\n    return {\n      //表格当前页数据\n      tableData: [],\n      //多选数组\n      multipleSelection: [],\n      //搜索条件\n      criteria: '',\n      //下拉菜单选项\n      select: '',\n      //默认每页数据量\n      pagesize: 10,\n      //默认高亮行数据id\n      highlightId: -1,\n      //当前页码\n      currentPage: 1,\n      //查询的页码\n      start: 1,\n      //默认数据总数\n      totalCount: 1000,\n      roles: [],//角色列表\n      editUserForm: {\n        geNumber: '',\n        userState: '',\n        roleId:'',\n        geName:''\n      },\n      addUserForm: {\n        geNumber: '',\n        geName: '',\n        userState: '',\n        roleId: '',\n        phone: '',\n        email: '',\n        password: ''\n      },\n      dialogFormVisible: false,\n      addFormVisible: false,\n      formLabelWidth: '120px',\n      rules: {\n        geNumber: [\n          { required: true, message: '请填写工号', trigger: 'blur' },\n          { min: 7, max: 7, message: '请填写7个字符的工号', trigger: 'blur' }\n        ],\n        geName: [\n          { required: true, message: '请填写姓名', trigger: 'blur' },\n          { min: 2, max: 4, message: '请填写2-4个字符的姓名', trigger: 'blur' }\n        ],\n        roleId: [\n          { required: true, message: '请选择角色', trigger: 'blur' }\n        ],\n        password: [\n          { required: true, message: '请填写密码', trigger: 'blur' },\n          { min: 6, max: 10, message: '请填写6-10个字符的密码', trigger: 'blur' }\n        ],\n        userState: [\n          { required: true, message: '请选择状态', trigger: 'blur' }\n        ],\n        phone: [\n          {\n            validator: (rule, value, callback) => {\n              let vdt = API.validate.VDATA(value, { \"required\": { msg: \"请输入手机号\" }, \"mphone\": { msg: \"请输入有效的手机号\" } })\n              if (!vdt.result) {\n                callback(new Error(vdt.msg))\n              } else {\n                callback();\n              }\n            },\n            trigger: 'blur'\n          }\n        ],\n        email: [\n          {\n            validator: (rule, value, callback) => {\n              let vdt = API.validate.VDATA(value, { \"required\": { msg: \"请输入邮箱\" }, \"email\": { msg: \"请输入有效的邮箱\" } })\n              if (!vdt.result) {\n                callback(new Error(vdt.msg))\n              } else {\n                callback();\n              }\n            },\n            trigger: 'blur'\n          }\n        ],\n      }\n    }\n  },\n  created() {\n    this.loadData(this.criteria, this.currentPage, this.pagesize);\n    if (this.hasPerm('user:add') || this.hasPerm('user:update')) {\n      this.getAllRoles();\n    }\n  },\n  methods: {\n    //从服务器读取数据\n    loadData: function (criteria, pageNum, pageSize) {\n      let params = {\n        'parameter': criteria,\n        'pageNum': pageNum,\n        'pageSize': pageSize\n      };\n      API.userUtil.getData(params).then(({ data }) => {\n        console.log(data);\n        if (data.status == 0) {\n          this.tableData = data.data.userData;\n          this.totalCount = data.data.number;\n        } else {\n          //this.$Message.error(data.msg);\n          this.$message(\"请求失败！\");\n        }\n      }).catch((data) => {\n        this.$message(\"请求失败ww！\");\n        console.log(data);\n      });\n    },\n    getAllRoles() {\n      this.api({\n        url: \"/api/user/getAllRoles\",\n        method: \"get\"\n      }).then(data => {\n        this.roles = data.list;\n      })\n    },\n    //多选响应\n    handleSelectionChange: function (val) {\n      this.multipleSelection = val;\n    },\n\n    //点击行响应\n    handleclick: function (row, event, column) {\n      this.highlightId = row.id;\n    },\n\n    //编辑\n    handleEdit: function (index, row) {\n      this.editUserForm.geNumber = row.geNumber;\n      this.editUserForm.userState = row.userState;\n      this.editUserForm.geName = row.geName;\n      this.dialogFormVisible = true;\n    },\n\n    //修改\n    editSubmitForm(editUserForm) {\n      let params = {\n        'geNumber': this.editUserForm.geNumber,\n        'userState': this.editUserForm.userState,\n        'geName': this.editUserForm.geName,\n        'roleId': this.editUserForm.roleId\n      };\n      this.$refs[editUserForm].validate((valid) => {\n        if (valid) {\n          API.userUtil.updateUser(params).then(({ data }) => {\n            if (data.data == true) {\n              this.dialogFormVisible = false;\n              this.loadData(this.criteria, this.currentPage, this.pagesize);\n              //this.editUserForm.resetFields();\n              this.$message(\"修改成功！\");\n              this.$refs['editUserForm'].resetFields();\n            } else {\n              this.$message(\"请求失败！\");\n              this.$refs['editUserForm'].resetFields();\n            }\n          }).catch((data) => {\n            this.$message(\"请求失败！\");\n            this.$refs['editUserForm'].resetFields();\n            console.log(data);\n          });\n        } else {\n          this.$message.error(\"请求失败！\");\n          this.$refs['editUserForm'].resetFields();\n          return false;\n        }\n      });\n    },\n\n    //添加用户\n    addSubmitForm(addUserForm) {\n      let params = {\n        'geNumber': this.addUserForm.geNumber,\n        'geName': this.addUserForm.geName,\n        'userState': this.addUserForm.userState,\n        'roleId': this.addUserForm.roleId,\n        'phone': this.addUserForm.phone,\n        'email': this.addUserForm.email,\n        'password': this.addUserForm.password\n      };\n\n      this.$refs[addUserForm].validate((valid) => {\n        if (valid) {\n          API.userUtil.addUser(params).then(({ data }) => {\n            if (data.data == true) {\n              this.addFormVisible = false;\n              this.$message(\"添加成功!\");\n              this.$refs['addUserForm'].resetFields();\n              this.loadData(this.criteria, this.currentPage, this.pagesize);\n            } else {\n              this.$message(data.data);\n              this.$refs['addUserForm'].resetFields();\n            }\n          }).catch((data) => {\n            this.$message(data.data);\n            this.$refs['addUserForm'].resetFields();\n            console.log(data);\n          });\n        } else {\n          return false;\n        }\n      });\n    },\n\n    //单行删除\n    handleDelete: function (index, row) {\n      let params = { 'geNumber': row.geNumber };\n      this.$confirm('此操作将永久删除“' + row.geNumber + '”, 是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        API.userUtil.deleteUser(params).then(({ data }) => {\n          if (data.data == true) {\n            this.$message({ type: 'success', message: '删除成功!' });\n            this.loadData(this.criteria, this.currentPage, this.pagesize);\n          } else {\n            this.$message({ type: 'info', message: '删除失败' });\n          }\n        }).catch((data) => {\n          this.$message(\"请求失败！\");\n        });\n        this.$message({ type: 'success', message: '删除成功!' });\n      }).catch(() => {\n        this.$message({ type: 'info', message: '已取消删除' });\n      })\n    },\n\n    //搜索\n    search: function () {\n      console.log(this.select);\n      this.loadData(this.criteria, this.currentPage, this.pagesize);\n    },\n    add: function () {\n      this.addFormVisible = true;\n    },\n    exportUser() {\n      window.location.href = \"http://localhost:8088/api/exportUser.do\";\n    },\n    /*\n        //多项删除\n        deletenames: function(){\n          if(this.multipleSelection.length==0)\n            return;\n          var array = [];\n          this.multipleSelection.forEach((item) = > {\n            array.push(item.id);\n          })\n      this.$http.post('../delete',{\"array\":array},{emulateJSON: true}).then(function(res){\n        this.loadData(this.criteria, this.currentPage, this.pagesize);\n            },function(){\n                console.log('failed');\n            });\n        },\n      */\n    //改变当前点击的行的class，高亮当前行\n    tableRowClassName: function (row, index) {\n      if (row.id == this.highlightId) {\n        return 'info-row';\n      }\n    },\n\n    //每页显示数据量变更\n    handleSizeChange: function (val) {\n      this.pagesize = val;\n      this.loadData(this.criteria, this.currentPage, this.pagesize);\n    },\n\n    //页码变更\n    handleCurrentChange: function (val) {\n      this.currentPage = val;\n      this.loadData(this.criteria, this.currentPage, this.pagesize);\n    },\n\n  },\n\n}\n</script>\n\n<style scoped>\n.el-select .el-input {\n  width: 110px;\n}\n\n.el-table .info-row {\n  background: #c9e5f5;\n}\n\n#top {\n  background: #20a0ff;\n  padding: 5px;\n  overflow: hidden;\n}\n</style>\n"]}]}