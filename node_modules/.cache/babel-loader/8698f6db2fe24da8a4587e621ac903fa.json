{"remainingRequest":"D:\\code\\energyCode-master\\node_modules\\babel-loader\\lib\\index.js!D:\\code\\energyCode-master\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\code\\energyCode-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\code\\energyCode-master\\src\\components\\page\\User.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\code\\energyCode-master\\src\\components\\page\\User.vue","mtime":1564553326000},{"path":"D:\\code\\energyCode-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1564553326000},{"path":"D:\\code\\energyCode-master\\node_modules\\babel-loader\\lib\\index.js","mtime":1564553326000},{"path":"D:\\code\\energyCode-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1564553326000},{"path":"D:\\code\\energyCode-master\\node_modules\\vue-loader\\lib\\index.js","mtime":1564553326000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport API from '@/api';\nimport Vue from 'vue';\nexport default {\n  data: function data() {\n    return {\n      //表格当前页数据\n      tableData: [],\n      //多选数组\n      multipleSelection: [],\n      //搜索条件\n      criteria: '',\n      //下拉菜单选项\n      select: '',\n      //默认每页数据量\n      pagesize: 10,\n      //默认高亮行数据id\n      highlightId: -1,\n      //当前页码\n      currentPage: 1,\n      //查询的页码\n      start: 1,\n      //默认数据总数\n      totalCount: 1000,\n      roles: [],\n      //角色列表\n      editUserForm: {\n        geNumber: '',\n        userState: '',\n        roleId: '',\n        geName: ''\n      },\n      addUserForm: {\n        geNumber: '',\n        geName: '',\n        userState: '',\n        roleId: '',\n        phone: '',\n        email: '',\n        password: ''\n      },\n      dialogFormVisible: false,\n      addFormVisible: false,\n      formLabelWidth: '120px',\n      rules: {\n        geNumber: [{\n          required: true,\n          message: '请填写工号',\n          trigger: 'blur'\n        }, {\n          min: 7,\n          max: 7,\n          message: '请填写7个字符的工号',\n          trigger: 'blur'\n        }],\n        geName: [{\n          required: true,\n          message: '请填写姓名',\n          trigger: 'blur'\n        }, {\n          min: 2,\n          max: 4,\n          message: '请填写2-4个字符的姓名',\n          trigger: 'blur'\n        }],\n        roleId: [{\n          required: true,\n          message: '请选择角色',\n          trigger: 'blur'\n        }],\n        password: [{\n          required: true,\n          message: '请填写密码',\n          trigger: 'blur'\n        }, {\n          min: 6,\n          max: 10,\n          message: '请填写6-10个字符的密码',\n          trigger: 'blur'\n        }],\n        userState: [{\n          required: true,\n          message: '请选择状态',\n          trigger: 'blur'\n        }],\n        phone: [{\n          validator: function validator(rule, value, callback) {\n            var vdt = API.validate.VDATA(value, {\n              \"required\": {\n                msg: \"请输入手机号\"\n              },\n              \"mphone\": {\n                msg: \"请输入有效的手机号\"\n              }\n            });\n\n            if (!vdt.result) {\n              callback(new Error(vdt.msg));\n            } else {\n              callback();\n            }\n          },\n          trigger: 'blur'\n        }],\n        email: [{\n          validator: function validator(rule, value, callback) {\n            var vdt = API.validate.VDATA(value, {\n              \"required\": {\n                msg: \"请输入邮箱\"\n              },\n              \"email\": {\n                msg: \"请输入有效的邮箱\"\n              }\n            });\n\n            if (!vdt.result) {\n              callback(new Error(vdt.msg));\n            } else {\n              callback();\n            }\n          },\n          trigger: 'blur'\n        }]\n      }\n    };\n  },\n  created: function created() {\n    this.loadData(this.criteria, this.currentPage, this.pagesize);\n\n    if (this.hasPerm('user:add') || this.hasPerm('user:update')) {\n      this.getAllRoles();\n    }\n  },\n  methods: {\n    //从服务器读取数据\n    loadData: function loadData(criteria, pageNum, pageSize) {\n      var _this = this;\n\n      var params = {\n        'parameter': criteria,\n        'pageNum': pageNum,\n        'pageSize': pageSize\n      };\n      API.userUtil.getData(params).then(function (_ref) {\n        var data = _ref.data;\n        console.log(data);\n\n        if (data.status == 0) {\n          _this.tableData = data.data.userData;\n          _this.totalCount = data.data.number;\n        } else {\n          //this.$Message.error(data.msg);\n          _this.$message(\"请求失败！\");\n        }\n      }).catch(function (data) {\n        _this.$message(\"请求失败ww！\");\n\n        console.log(data);\n      });\n    },\n    getAllRoles: function getAllRoles() {\n      var _this2 = this;\n\n      this.api({\n        url: \"/api/user/getAllRoles\",\n        method: \"get\"\n      }).then(function (data) {\n        _this2.roles = data.list;\n      });\n    },\n    //多选响应\n    handleSelectionChange: function handleSelectionChange(val) {\n      this.multipleSelection = val;\n    },\n    //点击行响应\n    handleclick: function handleclick(row, event, column) {\n      this.highlightId = row.id;\n    },\n    //编辑\n    handleEdit: function handleEdit(index, row) {\n      this.editUserForm.geNumber = row.geNumber;\n      this.editUserForm.userState = row.userState;\n      this.editUserForm.geName = row.geName;\n      this.dialogFormVisible = true;\n    },\n    //修改\n    editSubmitForm: function editSubmitForm(editUserForm) {\n      var _this3 = this;\n\n      var params = {\n        'geNumber': this.editUserForm.geNumber,\n        'userState': this.editUserForm.userState,\n        'geName': this.editUserForm.geName,\n        'roleId': this.editUserForm.roleId\n      };\n      this.$refs[editUserForm].validate(function (valid) {\n        if (valid) {\n          API.userUtil.updateUser(params).then(function (_ref2) {\n            var data = _ref2.data;\n\n            if (data.data == true) {\n              _this3.dialogFormVisible = false;\n\n              _this3.loadData(_this3.criteria, _this3.currentPage, _this3.pagesize); //this.editUserForm.resetFields();\n\n\n              _this3.$message(\"修改成功！\");\n\n              _this3.$refs['editUserForm'].resetFields();\n            } else {\n              _this3.$message(\"请求失败！\");\n\n              _this3.$refs['editUserForm'].resetFields();\n            }\n          }).catch(function (data) {\n            _this3.$message(\"请求失败！\");\n\n            _this3.$refs['editUserForm'].resetFields();\n\n            console.log(data);\n          });\n        } else {\n          _this3.$message.error(\"请求失败！\");\n\n          _this3.$refs['editUserForm'].resetFields();\n\n          return false;\n        }\n      });\n    },\n    //添加用户\n    addSubmitForm: function addSubmitForm(addUserForm) {\n      var _this4 = this;\n\n      var params = {\n        'geNumber': this.addUserForm.geNumber,\n        'geName': this.addUserForm.geName,\n        'userState': this.addUserForm.userState,\n        'roleId': this.addUserForm.roleId,\n        'phone': this.addUserForm.phone,\n        'email': this.addUserForm.email,\n        'password': this.addUserForm.password\n      };\n      this.$refs[addUserForm].validate(function (valid) {\n        if (valid) {\n          API.userUtil.addUser(params).then(function (_ref3) {\n            var data = _ref3.data;\n\n            if (data.data == true) {\n              _this4.addFormVisible = false;\n\n              _this4.$message(\"添加成功!\");\n\n              _this4.$refs['addUserForm'].resetFields();\n\n              _this4.loadData(_this4.criteria, _this4.currentPage, _this4.pagesize);\n            } else {\n              _this4.$message(data.data);\n\n              _this4.$refs['addUserForm'].resetFields();\n            }\n          }).catch(function (data) {\n            _this4.$message(data.data);\n\n            _this4.$refs['addUserForm'].resetFields();\n\n            console.log(data);\n          });\n        } else {\n          return false;\n        }\n      });\n    },\n    //单行删除\n    handleDelete: function handleDelete(index, row) {\n      var _this5 = this;\n\n      var params = {\n        'geNumber': row.geNumber\n      };\n      this.$confirm('此操作将永久删除“' + row.geNumber + '”, 是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(function () {\n        API.userUtil.deleteUser(params).then(function (_ref4) {\n          var data = _ref4.data;\n\n          if (data.data == true) {\n            _this5.$message({\n              type: 'success',\n              message: '删除成功!'\n            });\n\n            _this5.loadData(_this5.criteria, _this5.currentPage, _this5.pagesize);\n          } else {\n            _this5.$message({\n              type: 'info',\n              message: '删除失败'\n            });\n          }\n        }).catch(function (data) {\n          _this5.$message(\"请求失败！\");\n        });\n\n        _this5.$message({\n          type: 'success',\n          message: '删除成功!'\n        });\n      }).catch(function () {\n        _this5.$message({\n          type: 'info',\n          message: '已取消删除'\n        });\n      });\n    },\n    //搜索\n    search: function search() {\n      console.log(this.select);\n      this.loadData(this.criteria, this.currentPage, this.pagesize);\n    },\n    add: function add() {\n      this.addFormVisible = true;\n    },\n    exportUser: function exportUser() {\n      window.location.href = \"http://localhost:8088/api/exportUser.do\";\n    },\n\n    /*\n        //多项删除\n        deletenames: function(){\n          if(this.multipleSelection.length==0)\n            return;\n          var array = [];\n          this.multipleSelection.forEach((item) = > {\n            array.push(item.id);\n          })\n      this.$http.post('../delete',{\"array\":array},{emulateJSON: true}).then(function(res){\n        this.loadData(this.criteria, this.currentPage, this.pagesize);\n            },function(){\n                console.log('failed');\n            });\n        },\n      */\n    //改变当前点击的行的class，高亮当前行\n    tableRowClassName: function tableRowClassName(row, index) {\n      if (row.id == this.highlightId) {\n        return 'info-row';\n      }\n    },\n    //每页显示数据量变更\n    handleSizeChange: function handleSizeChange(val) {\n      this.pagesize = val;\n      this.loadData(this.criteria, this.currentPage, this.pagesize);\n    },\n    //页码变更\n    handleCurrentChange: function handleCurrentChange(val) {\n      this.currentPage = val;\n      this.loadData(this.criteria, this.currentPage, this.pagesize);\n    }\n  }\n};",{"version":3,"sources":["User.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div>\n    <!--\n    <div id=\"top\">\t\t\t\n\t\t\t<span>\n\t\t\t\t<el-button type=\"text\" @click=\"dialogFormVisible = true\" style=\"color:white\" >添加</el-button>\n\t\t\t\t<el-button type=\"text\" @click=\"deletenames\" style=\"color:white\">批量删除</el-button>\n\t\t\t</span>\t\t\t\t\t\t\n\t\t</div>\t\n    <br/>-->\n    <div style=\"margin-top:15px\">\n      <el-input placeholder=\"请输入内容\" v-model=\"criteria\" style=\"padding-bottom:10px;\">\n        <el-select v-model=\"select\" slot=\"prepend\" placeholder=\"请选择\">\n          <!--<el-option label=\"id\" value=\"1\"></el-option>-->\n          <el-option label=\"工号\" value=\"1\"></el-option>\n          <el-option label=\"姓名\" value=\"2\"></el-option>\n          <el-option label=\"状态\" value=\"3\"></el-option>\n          <el-option label=\"电话\" value=\"4\"></el-option>\n        </el-select>\n        <el-button slot=\"append\" icon=\"el-icon-search\" v-on:click=\"search\">查询</el-button>\n        <el-button slot=\"append\" icon=\"el-icon-plus\" v-on:click=\"add\">添加</el-button>\n        <el-button slot=\"append\" icon=\"el-icon-upload2\" v-on:click=\"exportUser\">导出</el-button>\n      </el-input>\n\n      <el-table\n        ref=\"testTable\"\n        :data=\"tableData\"\n        style=\"width:100%\"\n        border\n        :default-sort=\"{prop: 'id', order: 'ascending'}\"\n        @selection-change=\"handleSelectionChange\"\n        @row-click=\"handleclick\"\n        :row-class-name=\"tableRowClassName\"\n      >\n        <el-table-column type=\"selection\"></el-table-column>\n        <!--\n\t\t    <el-table-column\n\t\t      prop=\"id\"\n\t\t      label=\"Id\"\n\t\t      sortable\n\t\t      show-overflow-tooltip>\n        </el-table-column>-->\n        <el-table-column prop=\"geNumber\" width=\"95px\" label=\"工号\" sortable></el-table-column>\n        <el-table-column prop=\"geName\" label=\"姓名\" width=\"88px\" sortable></el-table-column>\n        <el-table-column prop=\"userState\" label=\"状态\" width=\"88px\" sortable></el-table-column>\n        <el-table-column prop=\"phone\" label=\"电话\" sortable></el-table-column>\n        <el-table-column prop=\"email\" label=\"邮箱\" sortable></el-table-column>\n        <el-table-column prop=\"createTime\" label=\"创建时间\" sortable></el-table-column>\n        <el-table-column prop=\"updateTime\" label=\"修改时间\" sortable></el-table-column>\n        <el-table-column label=\"操作\">\n          <template scope=\"scope\">\n            <el-button size=\"small\" type=\"primary\" @click=\"handleEdit(scope.$index, scope.row)\">编辑</el-button>\n            <el-button size=\"small\" type=\"danger\" @click=\"handleDelete(scope.$index, scope.row)\">删除</el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n\n      <el-dialog title=\"修改用户\" :visible.sync=\"dialogFormVisible\">\n        <el-form :model=\"editUserForm\" :rules=\"rules\" ref=\"editUserForm\">\n          <el-form-item label=\"用户工号\" :label-width=\"formLabelWidth\" prop=\"geNumber\">\n            <el-input v-model=\"editUserForm.geNumber\" auto-complete=\"off\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"用户状态\" :label-width=\"formLabelWidth\" prop=\"userState\">\n            <el-select v-model=\"editUserForm.userState\" placeholder=\"状态\">\n              <el-option label=\"有效\" value=\"有效\"></el-option>\n              <el-option label=\"无效\" value=\"无效\"></el-option>\n            </el-select>\n          </el-form-item>\n          <el-form-item label=\"姓名\" :label-width=\"formLabelWidth\" prop=\"geName\">\n            <el-input v-model=\"editUserForm.geName\" auto-complete=\"off\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"角色\" :label-width=\"formLabelWidth\" prop=\"roleId\">\n            <el-select v-model=\"editUserForm.roleId\" placeholder=\"请选择\">\n              <el-option\n                v-for=\"item in roles\"\n                :key=\"item.roleId\"\n                :label=\"item.roleName\"\n                :value=\"item.roleId\"\n              ></el-option>\n            </el-select>\n          </el-form-item>\n        </el-form>\n        <div slot=\"footer\" class=\"dialog-footer\">\n          <el-button @click=\"dialogFormVisible = false\">取 消</el-button>\n          <el-button type=\"primary\" @click=\"editSubmitForm('editUserForm')\">确 定</el-button>\n        </div>\n      </el-dialog>\n\n      <el-dialog title=\"添加用户\" :visible.sync=\"addFormVisible\">\n        <el-form :model=\"addUserForm\" :rules=\"rules\" ref=\"addUserForm\">\n          <el-form-item label=\"工号\" :label-width=\"formLabelWidth\" prop=\"geNumber\">\n            <el-input v-model=\"addUserForm.geNumber\" auto-complete=\"off\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"姓名\" :label-width=\"formLabelWidth\" prop=\"geName\">\n            <el-input v-model=\"addUserForm.geName\" auto-complete=\"off\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"角色\" :label-width=\"formLabelWidth\" prop=\"roleId\">\n            <el-select v-model=\"addUserForm.roleId\" placeholder=\"请选择\">\n              <el-option\n                v-for=\"item in roles\"\n                :key=\"item.roleId\"\n                :label=\"item.roleName\"\n                :value=\"item.roleId\"\n              ></el-option>\n            </el-select>\n          </el-form-item>\n          <el-form-item label=\"状态\" :label-width=\"formLabelWidth\" prop=\"userState\">\n            <el-select v-model=\"addUserForm.userState\" placeholder=\"状态\">\n              <el-option label=\"有效\" value=\"有效\"></el-option>\n              <el-option label=\"无效\" value=\"无效\"></el-option>\n            </el-select>\n          </el-form-item>\n          <el-form-item label=\"密码\" :label-width=\"formLabelWidth\" prop=\"password\">\n            <el-input v-model=\"addUserForm.password\" auto-complete=\"off\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"手机号\" :label-width=\"formLabelWidth\" prop=\"phone\">\n            <el-input v-model=\"addUserForm.phone\" auto-complete=\"off\"></el-input>\n          </el-form-item>\n          <el-form-item label=\"邮箱\" :label-width=\"formLabelWidth\" prop=\"email\">\n            <el-input v-model=\"addUserForm.email\" auto-complete=\"off\"></el-input>\n          </el-form-item>\n        </el-form>\n        <div slot=\"footer\" class=\"dialog-footer\">\n          <el-button @click=\"addFormVisible = false\">取 消</el-button>\n          <el-button type=\"primary\" @click=\"addSubmitForm('addUserForm')\">确 定</el-button>\n        </div>\n      </el-dialog>\n\n      <div align=\"center\">\n        <el-pagination\n          @size-change=\"handleSizeChange\"\n          @current-change=\"handleCurrentChange\"\n          :current-page=\"currentPage\"\n          :page-sizes=\"[5,10, 20, 30, 40]\"\n          :page-size=\"pagesize\"\n          layout=\"total, sizes, prev, pager, next, jumper\"\n          :total=\"totalCount\"\n        ></el-pagination>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport API from '@/api';\nimport Vue from 'vue';\nexport default {\n  data() {\n    return {\n      //表格当前页数据\n      tableData: [],\n      //多选数组\n      multipleSelection: [],\n      //搜索条件\n      criteria: '',\n      //下拉菜单选项\n      select: '',\n      //默认每页数据量\n      pagesize: 10,\n      //默认高亮行数据id\n      highlightId: -1,\n      //当前页码\n      currentPage: 1,\n      //查询的页码\n      start: 1,\n      //默认数据总数\n      totalCount: 1000,\n      roles: [],//角色列表\n      editUserForm: {\n        geNumber: '',\n        userState: '',\n        roleId:'',\n        geName:''\n      },\n      addUserForm: {\n        geNumber: '',\n        geName: '',\n        userState: '',\n        roleId: '',\n        phone: '',\n        email: '',\n        password: ''\n      },\n      dialogFormVisible: false,\n      addFormVisible: false,\n      formLabelWidth: '120px',\n      rules: {\n        geNumber: [\n          { required: true, message: '请填写工号', trigger: 'blur' },\n          { min: 7, max: 7, message: '请填写7个字符的工号', trigger: 'blur' }\n        ],\n        geName: [\n          { required: true, message: '请填写姓名', trigger: 'blur' },\n          { min: 2, max: 4, message: '请填写2-4个字符的姓名', trigger: 'blur' }\n        ],\n        roleId: [\n          { required: true, message: '请选择角色', trigger: 'blur' }\n        ],\n        password: [\n          { required: true, message: '请填写密码', trigger: 'blur' },\n          { min: 6, max: 10, message: '请填写6-10个字符的密码', trigger: 'blur' }\n        ],\n        userState: [\n          { required: true, message: '请选择状态', trigger: 'blur' }\n        ],\n        phone: [\n          {\n            validator: (rule, value, callback) => {\n              let vdt = API.validate.VDATA(value, { \"required\": { msg: \"请输入手机号\" }, \"mphone\": { msg: \"请输入有效的手机号\" } })\n              if (!vdt.result) {\n                callback(new Error(vdt.msg))\n              } else {\n                callback();\n              }\n            },\n            trigger: 'blur'\n          }\n        ],\n        email: [\n          {\n            validator: (rule, value, callback) => {\n              let vdt = API.validate.VDATA(value, { \"required\": { msg: \"请输入邮箱\" }, \"email\": { msg: \"请输入有效的邮箱\" } })\n              if (!vdt.result) {\n                callback(new Error(vdt.msg))\n              } else {\n                callback();\n              }\n            },\n            trigger: 'blur'\n          }\n        ],\n      }\n    }\n  },\n  created() {\n    this.loadData(this.criteria, this.currentPage, this.pagesize);\n    if (this.hasPerm('user:add') || this.hasPerm('user:update')) {\n      this.getAllRoles();\n    }\n  },\n  methods: {\n    //从服务器读取数据\n    loadData: function (criteria, pageNum, pageSize) {\n      let params = {\n        'parameter': criteria,\n        'pageNum': pageNum,\n        'pageSize': pageSize\n      };\n      API.userUtil.getData(params).then(({ data }) => {\n        console.log(data);\n        if (data.status == 0) {\n          this.tableData = data.data.userData;\n          this.totalCount = data.data.number;\n        } else {\n          //this.$Message.error(data.msg);\n          this.$message(\"请求失败！\");\n        }\n      }).catch((data) => {\n        this.$message(\"请求失败ww！\");\n        console.log(data);\n      });\n    },\n    getAllRoles() {\n      this.api({\n        url: \"/api/user/getAllRoles\",\n        method: \"get\"\n      }).then(data => {\n        this.roles = data.list;\n      })\n    },\n    //多选响应\n    handleSelectionChange: function (val) {\n      this.multipleSelection = val;\n    },\n\n    //点击行响应\n    handleclick: function (row, event, column) {\n      this.highlightId = row.id;\n    },\n\n    //编辑\n    handleEdit: function (index, row) {\n      this.editUserForm.geNumber = row.geNumber;\n      this.editUserForm.userState = row.userState;\n      this.editUserForm.geName = row.geName;\n      this.dialogFormVisible = true;\n    },\n\n    //修改\n    editSubmitForm(editUserForm) {\n      let params = {\n        'geNumber': this.editUserForm.geNumber,\n        'userState': this.editUserForm.userState,\n        'geName': this.editUserForm.geName,\n        'roleId': this.editUserForm.roleId\n      };\n      this.$refs[editUserForm].validate((valid) => {\n        if (valid) {\n          API.userUtil.updateUser(params).then(({ data }) => {\n            if (data.data == true) {\n              this.dialogFormVisible = false;\n              this.loadData(this.criteria, this.currentPage, this.pagesize);\n              //this.editUserForm.resetFields();\n              this.$message(\"修改成功！\");\n              this.$refs['editUserForm'].resetFields();\n            } else {\n              this.$message(\"请求失败！\");\n              this.$refs['editUserForm'].resetFields();\n            }\n          }).catch((data) => {\n            this.$message(\"请求失败！\");\n            this.$refs['editUserForm'].resetFields();\n            console.log(data);\n          });\n        } else {\n          this.$message.error(\"请求失败！\");\n          this.$refs['editUserForm'].resetFields();\n          return false;\n        }\n      });\n    },\n\n    //添加用户\n    addSubmitForm(addUserForm) {\n      let params = {\n        'geNumber': this.addUserForm.geNumber,\n        'geName': this.addUserForm.geName,\n        'userState': this.addUserForm.userState,\n        'roleId': this.addUserForm.roleId,\n        'phone': this.addUserForm.phone,\n        'email': this.addUserForm.email,\n        'password': this.addUserForm.password\n      };\n\n      this.$refs[addUserForm].validate((valid) => {\n        if (valid) {\n          API.userUtil.addUser(params).then(({ data }) => {\n            if (data.data == true) {\n              this.addFormVisible = false;\n              this.$message(\"添加成功!\");\n              this.$refs['addUserForm'].resetFields();\n              this.loadData(this.criteria, this.currentPage, this.pagesize);\n            } else {\n              this.$message(data.data);\n              this.$refs['addUserForm'].resetFields();\n            }\n          }).catch((data) => {\n            this.$message(data.data);\n            this.$refs['addUserForm'].resetFields();\n            console.log(data);\n          });\n        } else {\n          return false;\n        }\n      });\n    },\n\n    //单行删除\n    handleDelete: function (index, row) {\n      let params = { 'geNumber': row.geNumber };\n      this.$confirm('此操作将永久删除“' + row.geNumber + '”, 是否继续?', '提示', {\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).then(() => {\n        API.userUtil.deleteUser(params).then(({ data }) => {\n          if (data.data == true) {\n            this.$message({ type: 'success', message: '删除成功!' });\n            this.loadData(this.criteria, this.currentPage, this.pagesize);\n          } else {\n            this.$message({ type: 'info', message: '删除失败' });\n          }\n        }).catch((data) => {\n          this.$message(\"请求失败！\");\n        });\n        this.$message({ type: 'success', message: '删除成功!' });\n      }).catch(() => {\n        this.$message({ type: 'info', message: '已取消删除' });\n      })\n    },\n\n    //搜索\n    search: function () {\n      console.log(this.select);\n      this.loadData(this.criteria, this.currentPage, this.pagesize);\n    },\n    add: function () {\n      this.addFormVisible = true;\n    },\n    exportUser() {\n      window.location.href = \"http://localhost:8088/api/exportUser.do\";\n    },\n    /*\n        //多项删除\n        deletenames: function(){\n          if(this.multipleSelection.length==0)\n            return;\n          var array = [];\n          this.multipleSelection.forEach((item) = > {\n            array.push(item.id);\n          })\n      this.$http.post('../delete',{\"array\":array},{emulateJSON: true}).then(function(res){\n        this.loadData(this.criteria, this.currentPage, this.pagesize);\n            },function(){\n                console.log('failed');\n            });\n        },\n      */\n    //改变当前点击的行的class，高亮当前行\n    tableRowClassName: function (row, index) {\n      if (row.id == this.highlightId) {\n        return 'info-row';\n      }\n    },\n\n    //每页显示数据量变更\n    handleSizeChange: function (val) {\n      this.pagesize = val;\n      this.loadData(this.criteria, this.currentPage, this.pagesize);\n    },\n\n    //页码变更\n    handleCurrentChange: function (val) {\n      this.currentPage = val;\n      this.loadData(this.criteria, this.currentPage, this.pagesize);\n    },\n\n  },\n\n}\n</script>\n\n<style scoped>\n.el-select .el-input {\n  width: 110px;\n}\n\n.el-table .info-row {\n  background: #c9e5f5;\n}\n\n#top {\n  background: #20a0ff;\n  padding: 5px;\n  overflow: hidden;\n}\n</style>\n"],"sourceRoot":"src\\components\\page"}]}